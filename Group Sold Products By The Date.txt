SELECT sell_date, count(product) as num_sold, STRING_AGG(product, ',') within group (order by product) AS products
FROM (
select distinct sell_date , product
from Activities 
) as ditinctTable
group by sell_date