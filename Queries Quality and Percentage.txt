select query_name ,round(sum(1.0*rating/position)/count(position),2) as quality , round(count(case when rating < 3 then 1 else null end)*1.0/count(position)*100,2) as poor_query_percentage 
from Queries
group by query_name