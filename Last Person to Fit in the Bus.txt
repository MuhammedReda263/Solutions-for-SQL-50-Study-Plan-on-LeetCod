with newTable as (select *, SUM(Weight) OVER (ORDER BY Turn) as total
from Queue
 )

    select top 1 person_name
    from newTable
    where total <=1000
    order by total Desc